
    <html>
    <head>
        <title>Picam</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
                font-family: sans-serif; 
                background-color: white; 
                display: flex;
                flex-direction: column;
                height: 100vh;
                overflow: hidden;
            }
            .header {
                background-color: #333;
                color: white;
                padding: 1em;
                text-align: center;
                border-bottom: 1px solid #555;
            }
            .header h1 { font-size: 1.5em; margin: 0; }
            .header p { font-size: 0.9em; color: #aaa; margin: 0.5em 0 0 0; }
            .stream-container {
                flex: 1;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 0;
                overflow: hidden;
                width: 100%;
            }
            .stream-box {
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: #000;
                border: none;
                border-radius: 0;
                overflow: hidden;
            }
            .stream-box img { 
                width: 100%;
                height: 100%;
                object-fit: contain;
                display: block;
            }
            #aruco-info { 
                background-color: #333;
                color: white;
                padding: 1em;
                border-top: 1px solid #555;
                max-height: 150px;
                overflow-y: auto;
                font-size: 0.85em;
            }
            #aruco-info h2 { font-size: 1em; margin-bottom: 0.5em; }
            #aruco-info pre { 
                background-color: #222; 
                border: 1px solid #555; 
                padding: 0.5em; 
                white-space: pre-wrap; 
                word-wrap: break-word;
                font-size: 0.8em;
                color: #0f0;
            }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>Raspberry Pi Stream</h1>
            <p id="filename-display" style="display: none;">En attente du nom de fichier...</p>
        </div>
        <div class="stream-container">
            <div class="stream-box">
                <img src="/stream/undistorted_img" alt="Image Détordue">
            </div>
        </div>
        <div id="aruco-info">
            <h2>Tags ArUco Détectés</h2>
            <pre id="aruco-data-display">En attente de données...</pre>
        </div>
        <script>
            function fetchArucoData() {
                fetch('/aruco_data')
                    .then(response => response.json())
                    .then(data => {
                        const display = document.getElementById('aruco-data-display');
                        if (data && data.length > 0) {
                            display.textContent = JSON.stringify(data, null, 2);
                        } else {
                            display.textContent = 'no arucotag detected';
                        }
                    })
                    .catch(error => {
                        console.error('Erreur lors de la récupération des données ArUco:', error);
                        document.getElementById('aruco-data-display').textContent = 'Erreur de chargement.';
                    });
            }

            function fetchFilename() {
                fetch('/filename')
                    .then(response => response.json())
                    .then(data => {
                        const display = document.getElementById('filename-display');
                        if (data && data.filename) {
                            display.textContent = data.filename;
                        } else {
                            display.textContent = 'Nom de fichier non disponible.';
                        }
                    })
                    .catch(error => {
                        console.error('Erreur lors de la récupération du nom de fichier:', error);
                        document.getElementById('filename-display').textContent = 'Erreur de chargement du nom de fichier.';
                    });
            }

            // Récupérer les données 25 fois par secondes
            setInterval(fetchArucoData, 40);
            setInterval(fetchFilename, 40);

            // Premier appel au chargement de la page
            fetchArucoData();
            fetchFilename();
        </script>
    </body>
    </html>
    